---
import { Image } from 'astro:assets';

interface GalleryImage {
  src: ImageMetadata;
  alt: string;
  caption?: string;
}

interface Props {
  images: GalleryImage[];
  columns?: 2 | 3 | 4;
}

const { images, columns = 3 } = Astro.props;

const gridCols = {
  2: 'sm:grid-cols-2',
  3: 'sm:grid-cols-2 lg:grid-cols-3',
  4: 'sm:grid-cols-2 lg:grid-cols-4',
};
---

<div class={`grid gap-4 ${gridCols[columns]}`}>
  {images.map((image) => (
    <figure class="group relative overflow-hidden rounded-xl bg-gray-100">
      <Image
        src={image.src}
        alt={image.alt}
        widths={[400, 600, 800]}
        sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw"
        class="w-full h-64 object-cover transition-transform duration-300 group-hover:scale-105"
        format="webp"
        quality={80}
        loading="lazy"
      />
      {image.caption && (
        <figcaption class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-4 text-white text-sm opacity-0 group-hover:opacity-100 transition-opacity">
          {image.caption}
        </figcaption>
      )}
    </figure>
  ))}
</div>
